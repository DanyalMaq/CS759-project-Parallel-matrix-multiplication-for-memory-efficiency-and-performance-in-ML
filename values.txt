Distributed matmul with managed memory
nRowsA=32, nColsA=32, nColsA=32 num_gpus=2
Time taken for single GPU = 0.009216
Elapsed time on device 0: 0.033792 ms
Elapsed time on device 1: 0.172032 ms
Distributed matmul with manually allocated memory
Elapsed time on device 0: 0.033792 ms
Elapsed time on device 1: 0.009216 ms
Time taken for single GPU = 0.012288
Distributed matmul with async overlapping
Elasped time on GPU 0: 0.036864 ms
Elasped time on GPU 1: 1.418624 ms

Distributed matmul with managed memory
nRowsA=64, nColsA=64, nColsA=64 num_gpus=2
Time taken for single GPU = 0.015360
Elapsed time on device 0: 0.038912 ms
Elapsed time on device 1: 0.265216 ms
Distributed matmul with manually allocated memory
Elapsed time on device 0: 0.038912 ms
Elapsed time on device 1: 0.010240 ms
Time taken for single GPU = 0.013312
Distributed matmul with async overlapping
Elasped time on GPU 0: 0.038912 ms
Elasped time on GPU 1: 1.769920 ms

Distributed matmul with managed memory
nRowsA=128, nColsA=128, nColsA=128 num_gpus=2
Time taken for single GPU = 0.022528
Elapsed time on device 0: 0.041984 ms
Elapsed time on device 1: 0.484352 ms
Distributed matmul with manually allocated memory
Elapsed time on device 0: 0.043008 ms
Elapsed time on device 1: 0.014336 ms
Time taken for single GPU = 0.017408
Distributed matmul with async overlapping
Elasped time on GPU 0: 0.043008 ms
Elasped time on GPU 1: 1.799648 ms

Distributed matmul with managed memory
nRowsA=256, nColsA=256, nColsA=256 num_gpus=2
Time taken for single GPU = 0.027648
Elapsed time on device 0: 0.026624 ms
Elapsed time on device 1: 0.769024 ms
Distributed matmul with manually allocated memory
Elapsed time on device 0: 1.115200 ms
Elapsed time on device 1: 1.828480 ms
Time taken for single GPU = 1.592448
Distributed matmul with async overlapping
Elasped time on GPU 0: 0.026624 ms
Elasped time on GPU 1: 2.557952 ms

Distributed matmul with managed memory
nRowsA=512, nColsA=512, nColsA=512 num_gpus=2
Time taken for single GPU = 0.075776
Elapsed time on device 0: 0.072704 ms
Elapsed time on device 1: 1.958912 ms
Distributed matmul with manually allocated memory
Elapsed time on device 0: 0.075776 ms
Elapsed time on device 1: 1.077536 ms
Time taken for single GPU = 0.080416
Distributed matmul with async overlapping
Elasped time on GPU 0: 0.133120 ms
Elasped time on GPU 1: 2.436032 ms

Distributed matmul with managed memory
nRowsA=1024, nColsA=1024, nColsA=1024 num_gpus=2
Time taken for single GPU = 0.656384
Elapsed time on device 0: 0.380928 ms
Elapsed time on device 1: 13.563904 ms
Distributed matmul with manually allocated memory
Elapsed time on device 0: 0.391232 ms
Elapsed time on device 1: 1.463392 ms
Time taken for single GPU = 0.663232
Distributed matmul with async overlapping
Elasped time on GPU 0: 0.743424 ms
Elasped time on GPU 1: 2.807296 ms

Distributed matmul with managed memory
nRowsA=2048, nColsA=2048, nColsA=2048 num_gpus=2
Time taken for single GPU = 4.626432
Elapsed time on device 0: 2.365440 ms
Elapsed time on device 1: 55.507969 ms
Distributed matmul with manually allocated memory
Elapsed time on device 0: 2.317408 ms
Elapsed time on device 1: 2.659616 ms
Time taken for single GPU = 4.515456
Distributed matmul with async overlapping
Elasped time on GPU 0: 4.504576 ms
Elasped time on GPU 1: 9.565536 ms

Distributed matmul with managed memory
nRowsA=4096, nColsA=4096, nColsA=4096 num_gpus=2
Time taken for single GPU = 27.681791
Elapsed time on device 0: 842.564636 ms
Elapsed time on device 1: 869.336060 ms
Distributed matmul with manually allocated memory
Elapsed time on device 0: 13.582720 ms
Elapsed time on device 1: 13.548640 ms
Time taken for single GPU = 26.849119
Distributed matmul with async overlapping
Elasped time on GPU 0: 27.729919 ms
Elasped time on GPU 1: 41.518017 ms

Distributed matmul with managed memory
nRowsA=8192, nColsA=8192, nColsA=8192 num_gpus=2
Time taken for single GPU = 223.667206
Elapsed time on device 0: 17340.900391 ms
Elapsed time on device 1: 17365.339844 ms
Distributed matmul with manually allocated memory
Elapsed time on device 0: 106.267006 ms
Elapsed time on device 1: 106.268227 ms
Time taken for single GPU = 223.520035
Distributed matmul with async overlapping
Elasped time on GPU 0: 223.314941 ms
Elasped time on GPU 1: 299.005463 ms

Distributed matmul with managed memory
nRowsA=16384, nColsA=16384, nColsA=16384 num_gpus=2
Time taken for single GPU = 1772.868652
Elapsed time on device 0: 139037.875000 ms
Elapsed time on device 1: 138992.703125 ms
Distributed matmul with manually allocated memory
Elapsed time on device 0: 972.633606 ms
Elapsed time on device 1: 935.173828 ms
Time taken for single GPU = 1791.958740
Distributed matmul with async overlapping
Elasped time on GPU 0: 1790.228516 ms
Elasped time on GPU 1: 1889.017334 ms

---------------------------------------------
Distributed matmul with managed memory
Params for testing:
nRowsA=32, nColsA=32, nColsA=96 num_gpus=2
Launching 8 blocks of 1024 threads each
Time taken for single GPU = 0.011264
Launching 4 blocks of 1024 threads each
Launching 4 blocks of 1024 threads each
Elapsed time on device 0: 0.027648 ms
Elapsed time on device 1: 0.471040 ms
---------------------------------------------
Distributed matmul with manually allocated memory
Elapsed time on device 0: 0.370849 ms
Elapsed time on device 1: 0.113470 ms
Launching 8 blocks of 1024 threads each
Time taken for single GPU = 0.010240
----------------------------------------
Distributed matmul with async overlapping
Launching 4 blocks of 1024 threads each
Launching 4 blocks of 1024 threads each
Elasped time on GPU 0: 0.025600 ms
Elasped time on GPU 1: 0.018688 ms
Matmul First value output: 32.000000
 Middle value output: 32.000000
 Last value output: 32.000000
root@69826f4019a0:/fly# bash timming.sh
----------------------------------------
Distributed matmul with async overlapping
Launching 4 blocks of 1024 threads each
Launching 4 blocks of 1024 threads each
Elasped time on GPU 0: 0.027648 ms
Elasped time on GPU 1: 0.019584 ms
Matmul First value output: 32.000000
 Middle value output: 32.000000
 Last value output: 32.000000
----------------------------------------
Distributed matmul with async overlapping
Launching 9 blocks of 1024 threads each
Launching 9 blocks of 1024 threads each
Elasped time on GPU 0: 0.040960 ms
Elasped time on GPU 1: 0.025088 ms
Matmul First value output: 64.000000
 Middle value output: 64.000000
 Last value output: 64.000000
----------------------------------------
Distributed matmul with async overlapping
Launching 25 blocks of 1024 threads each
Launching 25 blocks of 1024 threads each
Elasped time on GPU 0: 0.035840 ms
Elasped time on GPU 1: 0.025728 ms
Matmul First value output: 128.000000
 Middle value output: 128.000000
 Last value output: 128.000000
----------------------------------------
Distributed matmul with async overlapping
Launching 81 blocks of 1024 threads each
Launching 81 blocks of 1024 threads each
Elasped time on GPU 0: 0.058368 ms
Elasped time on GPU 1: 0.046720 ms
Matmul First value output: 256.000000
 Middle value output: 256.000000
 Last value output: 256.000000
----------------------------------------
Distributed matmul with async overlapping
Launching 289 blocks of 1024 threads each
Launching 289 blocks of 1024 threads each
Elasped time on GPU 0: 0.133120 ms
Elasped time on GPU 1: 0.142368 ms
Matmul First value output: 512.000000
 Middle value output: 512.000000
 Last value output: 512.000000
----------------------------------------
Distributed matmul with async overlapping
Launching 1089 blocks of 1024 threads each
Launching 1089 blocks of 1024 threads each
Elasped time on GPU 0: 0.875520 ms
Elasped time on GPU 1: 0.886112 ms
Matmul First value output: 1024.000000
 Middle value output: 1024.000000
 Last value output: 1024.000000
----------------------------------------
Distributed matmul with async overlapping
Launching 4225 blocks of 1024 threads each
Launching 4225 blocks of 1024 threads each
Elasped time on GPU 0: 6.257664 ms
Elasped time on GPU 1: 6.267264 ms
Matmul First value output: 2048.000000
 Middle value output: 2048.000000
 Last value output: 2048.000000
----------------------------------------
Distributed matmul with async overlapping
Launching 16641 blocks of 1024 threads each
Launching 16641 blocks of 1024 threads each
Elasped time on GPU 0: 27.486208 ms
Elasped time on GPU 1: 49.505791 ms
Matmul First value output: 4096.000000
 Middle value output: 4096.000000
 Last value output: 4096.000000
----------------------------------------
Distributed matmul with async overlapping
Launching 66049 blocks of 1024 threads each
Launching 66049 blocks of 1024 threads each
Elasped time on GPU 0: 225.467392 ms
Elasped time on GPU 1: 322.628235 ms
Matmul First value output: 8192.000000
 Middle value output: 8192.000000
 Last value output: 8192.000000
----------------------------------------
Distributed matmul with async overlapping
Launching 263169 blocks of 1024 threads each
Launching 263169 blocks of 1024 threads each
Elasped time on GPU 0: 1795.524658 ms
Elasped time on GPU 1: 1859.319702 ms
Matmul First value output: 16384.000000
 Middle value output: 16384.000000
 Last value output: 16384.000000
----------------------------------------
Distributed matmul with async overlapping
CUDA Runtime Error at: test_async.cu:52
